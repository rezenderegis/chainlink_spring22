# BlockReceipts Script To Mint Tokens

## Introduction 

Welcome!

The script of NFT.js could be used in any transaction response to be executed, and mint a NFT Token. 

For testing purposes we are simulating that we got the json object from a transaction on line 5 (NFT.js), and we already have the wallet address (line 8) of an user which will be the owner of the NFT created:

```
//Example of JSON generated after a transaction from shopify
const JSONTransaction = {"order":{"id":4739692560597,"admin_graphql_api_id":"gid:\/\/shopify\/Order\/4739692560597","app_id":580111,"browser_ip":"76.90.38.107","buyer_accepts_marketing":false,"cancel_reason":null,"cancelled_at":null,"cart_token":"25b840b203f6a6c5146986ef994397fe","checkout_id":32650160308437,"checkout_token":"7f4935c251cacfa69ecb698c94cf3eab","client_details":{"accept_language":"en-US,en;q=0.9","browser_height":739,"browser_ip":"76.90.38.107","browser_width":1440,"session_hash":null,"user_agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/100.0.4896.127 Safari\/537.36"},"closed_at":"2022-05-07T12:46:26-07:00","confirmed":true,"contact_email":"test@houseofquorum.com","created_at":"2022-05-07T09:49:03-07:00","currency":"USD","current_subtotal_price":"89999.00","current_subtotal_price_set":{"shop_money":{"amount":"89999.00","currency_code":"USD"},"presentment_money":{"amount":"89999.00","currency_code":"USD"}},"current_total_discounts":"0.00","current_total_discounts_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"current_total_duties_set":null,"current_total_price":"96523.93","current_total_price_set":{"shop_money":{"amount":"96523.93","currency_code":"USD"},"presentment_money":{"amount":"96523.93","currency_code":"USD"}},"current_total_tax":"6524.93","current_total_tax_set":{"shop_money":{"amount":"6524.93","currency_code":"USD"},"presentment_money":{"amount":"6524.93","currency_code":"USD"}},"customer_locale":"en-US","device_id":null,"discount_codes":[],"email":"test@houseofquorum.com","estimated_taxes":false,"financial_status":"paid","fulfillment_status":"fulfilled","gateway":"bogus","landing_site":"\/password","landing_site_ref":null,"location_id":null,"name":"#1001","note":null,"note_attributes":[],"number":1,"order_number":1001,"order_status_url":"https:\/\/blockreceipts.myshopify.com\/64230392021\/orders\/5f644c6b0ba9235a2647b7a268c7fa04\/authenticate?key=a4c13b24d4e5b774d5748296288eb749","original_total_duties_set":null,"payment_gateway_names":["bogus"],"phone":null,"presentment_currency":"USD","processed_at":"2022-05-07T09:49:02-07:00","processing_method":"direct","reference":null,"referring_site":"","source_identifier":null,"source_name":"web","source_url":null,"subtotal_price":"89999.00","subtotal_price_set":{"shop_money":{"amount":"89999.00","currency_code":"USD"},"presentment_money":{"amount":"89999.00","currency_code":"USD"}},"tags":"","tax_lines":[{"price":"6524.93","rate":0.0725,"title":"California State Tax","price_set":{"shop_money":{"amount":"6524.93","currency_code":"USD"},"presentment_money":{"amount":"6524.93","currency_code":"USD"}},"channel_liable":false}],"taxes_included":false,"test":true,"token":"5f644c6b0ba9235a2647b7a268c7fa04","total_discounts":"0.00","total_discounts_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"total_line_items_price":"89999.00","total_line_items_price_set":{"shop_money":{"amount":"89999.00","currency_code":"USD"},"presentment_money":{"amount":"89999.00","currency_code":"USD"}},"total_outstanding":"0.00","total_price":"96523.93","total_price_set":{"shop_money":{"amount":"96523.93","currency_code":"USD"},"presentment_money":{"amount":"96523.93","currency_code":"USD"}},"total_price_usd":"96523.93","total_shipping_price_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"total_tax":"6524.93","total_tax_set":{"shop_money":{"amount":"6524.93","currency_code":"USD"},"presentment_money":{"amount":"6524.93","currency_code":"USD"}},"total_tip_received":"0.00","total_weight":1302263,"updated_at":"2022-05-07T12:46:26-07:00","user_id":null,"billing_address":{"first_name":"Jon","address1":"1234 Kings Landing","phone":null,"city":"The Wall","zip":"92342","province":"California","country":"United States","last_name":"Snow","address2":"","company":null,"latitude":34.7612737,"longitude":-117.3381427,"name":"Jon Snow","country_code":"US","province_code":"CA"},"customer":{"id":6203370438869,"email":"test@houseofquorum.com","accepts_marketing":false,"created_at":"2022-05-07T09:47:10-07:00","updated_at":"2022-05-07T09:49:03-07:00","first_name":"Jon","last_name":"Snow","orders_count":0,"state":"disabled","total_spent":"0.00","last_order_id":null,"note":null,"verified_email":true,"multipass_identifier":null,"tax_exempt":false,"phone":null,"tags":"","last_order_name":null,"currency":"USD","accepts_marketing_updated_at":"2022-05-07T09:47:10-07:00","marketing_opt_in_level":null,"email_marketing_consent":{"state":"not_subscribed","opt_in_level":"single_opt_in","consent_updated_at":null},"sms_marketing_consent":null,"admin_graphql_api_id":"gid:\/\/shopify\/Customer\/6203370438869","default_address":{"id":7674296303829,"customer_id":6203370438869,"first_name":"Jon","last_name":"Snow","company":null,"address1":"1234 Kings Landing","address2":"","city":"The Wall","province":"California","country":"United States","zip":"92342","phone":null,"name":"Jon Snow","province_code":"CA","country_code":"US","country_name":"United States","default":true}},"discount_applications":[],"fulfillments":[{"id":4238298251477,"admin_graphql_api_id":"gid:\/\/shopify\/Fulfillment\/4238298251477","created_at":"2022-05-07T12:46:25-07:00","location_id":69013635285,"name":"#1001.1","order_id":4739692560597,"origin_address":{},"receipt":{},"service":"manual","shipment_status":null,"status":"success","tracking_company":null,"tracking_number":null,"tracking_numbers":[],"tracking_url":null,"tracking_urls":[],"updated_at":"2022-05-07T12:46:25-07:00","line_items":[{"id":12117543452885,"admin_graphql_api_id":"gid:\/\/shopify\/LineItem\/12117543452885","fulfillable_quantity":0,"fulfillment_service":"manual","fulfillment_status":"fulfilled","gift_card":false,"grams":1302264,"name":"2017 Porsche 911 - Blue \/ Sports","origin_location":{"id":3467777507541,"country_code":"US","province_code":"CA","name":"blockreceipts","address1":"1876 Fir St.","address2":"","city":"Corona","zip":"92882"},"price":"89999.00","price_set":{"shop_money":{"amount":"89999.00","currency_code":"USD"},"presentment_money":{"amount":"89999.00","currency_code":"USD"}},"product_exists":true,"product_id":7696781213909,"properties":[],"quantity":1,"requires_shipping":true,"sku":"2017Porsche911","taxable":true,"title":"2017 Porsche 911","total_discount":"0.00","total_discount_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"variant_id":43033301942485,"variant_inventory_management":"shopify","variant_title":"Blue \/ Sports","vendor":"blockreceipts","tax_lines":[{"channel_liable":false,"price":"6524.93","price_set":{"shop_money":{"amount":"6524.93","currency_code":"USD"},"presentment_money":{"amount":"6524.93","currency_code":"USD"}},"rate":0.0725,"title":"California State Tax"}],"duties":[],"discount_allocations":[]}]}],"line_items":[{"id":12117543452885,"admin_graphql_api_id":"gid:\/\/shopify\/LineItem\/12117543452885","fulfillable_quantity":0,"fulfillment_service":"manual","fulfillment_status":"fulfilled","gift_card":false,"grams":1302264,"name":"2017 Porsche 911 - Blue \/ Sports","origin_location":{"id":3467777507541,"country_code":"US","province_code":"CA","name":"blockreceipts","address1":"1876 Fir St.","address2":"","city":"Corona","zip":"92882"},"price":"89999.00","price_set":{"shop_money":{"amount":"89999.00","currency_code":"USD"},"presentment_money":{"amount":"89999.00","currency_code":"USD"}},"product_exists":true,"product_id":7696781213909,"properties":[],"quantity":1,"requires_shipping":true,"sku":"2017Porsche911","taxable":true,"title":"2017 Porsche 911","total_discount":"0.00","total_discount_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"variant_id":43033301942485,"variant_inventory_management":"shopify","variant_title":"Blue \/ Sports","vendor":"blockreceipts","tax_lines":[{"channel_liable":false,"price":"6524.93","price_set":{"shop_money":{"amount":"6524.93","currency_code":"USD"},"presentment_money":{"amount":"6524.93","currency_code":"USD"}},"rate":0.0725,"title":"California State Tax"}],"duties":[],"discount_allocations":[]}],"payment_details":{"credit_card_bin":"1","avs_result_code":null,"cvv_result_code":null,"credit_card_number":"•••• •••• •••• 1","credit_card_company":"Bogus"},"payment_terms":null,"refunds":[],"shipping_address":{"first_name":"Jon","address1":"1234 Kings Landing","phone":null,"city":"The Wall","zip":"92342","province":"California","country":"United States","last_name":"Snow","address2":"","company":null,"latitude":34.7612737,"longitude":-117.3381427,"name":"Jon Snow","country_code":"US","province_code":"CA"},"shipping_lines":[{"id":3946155802837,"carrier_identifier":null,"code":"Economy","delivery_category":null,"discounted_price":"0.00","discounted_price_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"phone":null,"price":"0.00","price_set":{"shop_money":{"amount":"0.00","currency_code":"USD"},"presentment_money":{"amount":"0.00","currency_code":"USD"}},"requested_fulfillment_service_id":null,"source":"shopify","title":"Economy","tax_lines":[],"discount_allocations":[]}]}}
```

which this part of the information is used to create a new json object which it is required to be sent to piñata to get a hash from ipfs.

```
//For now we will use a harcoded image, but this part can be dinamycally - just adding this for the MVP
const mJSON = {
    pinataMetadata: {
        name: mName
    },
    pinataContent: {
        "description" : "Block Receipts - Team: David, Fabricio & Antonio", 
        "image" : "https://gateway.pinata.cloud/ipfs/QmRoVerJ4WMizkMeUPQixbxhYUUvs3jgGVTARyC3rnwmQV", 
        "name" : "BLOCK-RCPT",
        "data" : JSONTransaction
    }
}
```
then when we have the right JSON format with all the information required, we will need also the wallet address of the user who is going to be the owner of the NFT created.

## Execute script 

```
node NFT.js
[pinJSONToIPFS] - Start
Qma8JKgo4j2srjm7Vi1SBrSLqFobC6X1qd3QtPis5pjpis
The hash of your transaction is:  0x0a5636a5fccbc899b49b2ec1002e111248b3a0b825bda21c0a8ed3ebd0b0e2db 
Check goerli etherscan the status of your transaction!
https://goerli.etherscan.io/tx/0x0a5636a5fccbc899b49b2ec1002e111248b3a0b825bda21c0a8ed3ebd0b0e2db
```


Etherscan goerli
https://goerli.etherscan.io/tx/0x0a5636a5fccbc899b49b2ec1002e111248b3a0b825bda21c0a8ed3ebd0b0e2db

## Note:
For security reason in the file of startMinting.js there are two variables which their values are empty PUBLIC_KEY, and PRIVATE_KEY. These variables PUBLIC_KEY should have a wallet address of the goerli test network, and the value of the PRIVATE_KEY variable it is the private key of the PUBLIC_KEY; To get it user could try to select the account from metamask, and select the three dots which they are next to the wallet address, and select accounts details, then export private keys, so once you have updated these values, and maybe updated the walletAddress from the file of NFT to receive the token, user will be able to execute the node NFT.js to generate the NFT.
